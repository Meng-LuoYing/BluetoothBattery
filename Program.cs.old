using System;
using System.Threading.Tasks;

namespace BluetoothBatteryReader
{
    class Program
    {
        static async Task Main(string[] args)
        {
            Console.WriteLine("=== 蓝牙设备电池电量读取工具 ===\n");
            
            while (true)
            {
                Console.WriteLine("\n请选择操作:");
                Console.WriteLine("1. 扫描蓝牙设备");
                Console.WriteLine("2. 读取设备电池电量 (通过设备ID)");
                Console.WriteLine("3. 读取设备电池电量 (通过设备名称)");
                Console.WriteLine("4. 监听电池电量变化");
                Console.WriteLine("5. 退出");
                Console.Write("\n请输入选项 (1-5): ");
                
                var choice = Console.ReadLine();
                
                switch (choice)
                {
                    case "1":
                        await BatteryReader.ScanBluetoothDevicesAsync();
                        break;
                        
                    case "2":
                        Console.Write("请输入设备ID: ");
                        var deviceId = Console.ReadLine();
                        if (!string.IsNullOrWhiteSpace(deviceId))
                        {
                            await BatteryReader.ReadBatteryLevelAsync(deviceId);
                        }
                        break;
                        
                    case "3":
                        Console.Write("请输入设备名称: ");
                        var deviceName = Console.ReadLine();
                        if (!string.IsNullOrWhiteSpace(deviceName))
                        {
                            await BatteryReader.ReadBatteryLevelByNameAsync(deviceName);
                        }
                        break;
                        
                    case "4":
                        Console.Write("请输入设备ID: ");
                        var monitorDeviceId = Console.ReadLine();
                        if (!string.IsNullOrWhiteSpace(monitorDeviceId))
                        {
                            await BatteryReader.MonitorBatteryLevelAsync(monitorDeviceId);
                        }
                        break;
                        
                    case "5":
                        Console.WriteLine("再见!");
                        return;
                        
                    default:
                        Console.WriteLine("无效的选项，请重试");
                        break;
                }
            }
        }
    }
}
